<!DOCTYPE html>
<html lang = "en">
<head>
    <meta charset="utf-8" />

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- JSZip library -->
    <script src="js/jszip.min.js"></script>
    <script src="js/jszip-utils.min.js"></script>
    <script src="js/FileSaver.min.js"></script>


    <title>PRISM Scripts Setup</title>

    <link rel="shortcut icon" type="image/png" href="img/BlueZoneScripts.png"/>
    <script>

    function scriptsSetupPRISM() {
        var zip = new JSZip();
        zip.file("README.txt", "Welcome to the jungle\n");


        function redirectFile(scriptToRedirectTo) {
            return "'LOADING GLOBAL VARIABLES--------------------------------------------------------------------"                                                                                  + "\n" +
                "Set run_another_script_fso = CreateObject(\"Scripting.FileSystemObject\")"                                                                                                         + "\n" +
                "Set fso_command = run_another_script_fso.OpenTextFile(\"C:\\DHS-PRISM-Scripts\\Script Files\\SETTINGS - GLOBAL VARIABLES.vbs\")"                                                   + "\n" +
                "text_from_the_other_script = fso_command.ReadAll"                                                                                                                                  + "\n" +
                "fso_command.Close"                                                                                                                                                                 + "\n" +
                "Execute text_from_the_other_script"                                                                                                                                                + "\n" +
                ""                                                                                                                                                                                  + "\n" +
                "'LOADING SCRIPT"                                                                                                                                                                   + "\n" +
                "script_URL = script_repository & \"" + scriptToRedirectTo +  "\""                                                                                                                  + "\n" +
                "IF run_locally = False THEN"                                                                                                                                                       + "\n" +
                "   SET req = CreateObject(\"Msxml2.XMLHttp.6.0\")				'Creates an object to get a URL"                                                                                    + "\n" +
                "   req.open \"GET\", script_URL, FALSE							'Attempts to open the URL"                                                                                          + "\n" +
                "   req.send													'Sends request"                                                                                                     + "\n" +
                "   IF req.Status = 200 THEN									'200 means great success"                                                                                           + "\n" +
                "       Set fso = CreateObject(\"Scripting.FileSystemObject\")	'Creates an FSO"                                                                                                    + "\n" +
                "       Execute req.responseText								'Executes the script code"                                                                                          + "\n" +
                "   ELSE														'Error message, tells user to try to reach github.com, otherwise instructs to contact someone/stops script"         + "\n" +
                "       critical_error_msgbox = MsgBox (\"Something has gone wrong. The code stored on GitHub was not able to be reached.\" & vbNewLine & vbNewLine &_"                             + "\n" +
                "                                \"Script URL: \" & script_URL & vbNewLine & vbNewLine &_"                                                                                          + "\n" +
                "                                \"The script has stopped. Please check your Internet connection. Consult a scripts administrator with any questions.\", _"                         + "\n" +
                "                                vbOKonly + vbCritical, \"BlueZone Scripts Critical Error\")"                                                                                       + "\n" +
                "                                StopScript"                                                                                                                                        + "\n" +
                "   END IF"                                                                                                                                                                         + "\n" +
                "ELSE"                                                                                                                                                                              + "\n" +
                "   Set run_another_script_fso = CreateObject(\"Scripting.FileSystemObject\")"                                                                                                      + "\n" +
                "   Set fso_command = run_another_script_fso.OpenTextFile(script_URL)"                                                                                                              + "\n" +
                "   text_from_the_other_script = fso_command.ReadAll"                                                                                                                               + "\n" +
                "   fso_command.Close"                                                                                                                                                              + "\n" +
                "   Execute text_from_the_other_script"                                                                                                                                             + "\n" +
                "END IF"                                                                                                                                                                            + "\n";

        }




        zip.file("Script Files/REDIRECT - ACTIONS.vbs",                             redirectFile("/ACTIONS/ACTIONS - MAIN MENU.vbs"));
        zip.file("Script Files/REDIRECT - AGENCY CUSTOMIZED.vbs",                   redirectFile("/AGENCY CUSTOMIZED/SOURCE/AGENCY CUSTOMIZED.vbs"));
        zip.file("Script Files/REDIRECT - BULK.vbs",                                redirectFile("/BULK/BULK - MAIN MENU.vbs"));
        zip.file("Script Files/REDIRECT - NAV - CAAD.vbs",                          redirectFile("/NAV/NAV - CAAD.vbs"));
        zip.file("Script Files/REDIRECT - NAV - CAFS.vbs",                          redirectFile("/NAV/NAV - CAFS.vbs"));
        zip.file("Script Files/REDIRECT - NAV - CAPS.vbs",                          redirectFile("/NAV/NAV - CAPS.vbs"));
        zip.file("Script Files/REDIRECT - NAV - CAST.vbs",                          redirectFile("/NAV/NAV - CAST.vbs"));
        zip.file("Script Files/REDIRECT - NAV - CAWT.vbs",                          redirectFile("/NAV/NAV - CAWT.vbs"));
        zip.file("Script Files/REDIRECT - NAV - CPDD.vbs",                          redirectFile("/NAV/NAV - CPDD.vbs"));
        zip.file("Script Files/REDIRECT - NAV - ENFL.vbs",                          redirectFile("/NAV/NAV - ENFL.vbs"));
        zip.file("Script Files/REDIRECT - NAV - FIND THAT SCREEN IN PRISM.vbs",     redirectFile("/NAV/NAV - FIND THAT SCREEN IN PRISM.vbs"));
        zip.file("Script Files/REDIRECT - NAV - MAXIS SCREEN FINDER.vbs",           redirectFile("/NAV/NAV - MAXIS SCREEN FINDER.vbs"));
        zip.file("Script Files/REDIRECT - NAV - NCDD.vbs",                          redirectFile("/NAV/NAV - NCDD.vbs"));
        zip.file("Script Files/REDIRECT - NAV - NCID.vbs",                          redirectFile("/NAV/NAV - NCID.vbs"));
        zip.file("Script Files/REDIRECT - NAV - PALC.vbs",                          redirectFile("/NAV/NAV - PALC.vbs"));
        zip.file("Script Files/REDIRECT - NAV - PAPL.vbs",                          redirectFile("/NAV/NAV - PAPL.vbs"));
        zip.file("Script Files/REDIRECT - NAV - PESE.vbs",                          redirectFile("/NAV/NAV - PESE.vbs"));
        zip.file("Script Files/REDIRECT - NAV - SUCW.vbs",                          redirectFile("/NAV/NAV - SUCW.vbs"));
        zip.file("Script Files/REDIRECT - NAV - USWD.vbs",                          redirectFile("/NAV/NAV - USWD.vbs"));
        zip.file("Script Files/REDIRECT - NOTES.vbs",                               redirectFile("/NOTES/NOTES - MAIN MENU.vbs"));
        zip.file("Script Files/REDIRECT - NOTES - QUICK CAAD.vbs",                  redirectFile("/NOTES/NOTES - QUICK CAAD.vbs"));
        zip.file("Script Files/REDIRECT - UTILITIES.vbs",                           redirectFile("/UTILITIES/UTILITIES - MAIN MENU.vbs"));

        //Getting the Power Pad
//        JSZipUtils.getBinaryContent("pads/PAD%20-%20CS.pad", function (err, data) {
//            if(err) {
//                throw err; // or handle the error
//            }
//            var zip = new JSZip();
//            zip.file("PAD - CS.pad", data, {binary:true});
//        };



        zip.generateAsync({type:"blob"})
        .then(function(content) {
            // see FileSaver.js
            saveAs(content, "PRISM scripts.zip");
        });

    }

    </script>

</head>
<body>

    <div class="container">


    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">BlueZone Scripts Setup Utility</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-navbar-collapse-1">

          <ul class="nav navbar-nav navbar-right">
            <li><a href="howto.html">How to use this installer</a></li>
            <li><a href="MAXIS.html">MAXIS scripts</a></li>
            <li class="active"><a href="PRISM.html">PRISM scripts</a></li>

          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>

    <div class="col-xs-12">
        Coming soon

    </div>
    <div class="col-xs-12">
        <button onclick="scriptsSetupPRISM()" class="btn btn-primary btn-sm" type="button">Download</button>
    </div>







    </div>



</body>

</html>
